<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=10">
<title>食品安全营养信息平台</title>
<link rel="stylesheet" href="../../resource/css/reset.css"/>
<link rel="stylesheet" href="../../resource/css/text.css" />
<link rel="stylesheet" href="../../resource/css/grid.css" />
<link href="../../resource/kendoui/styles/kendo.common.min.css" rel="stylesheet" />
<link rel="stylesheet/less" type="text/css" href="../../resource/kendoui/styles/kendo.metro.less" />
<link rel="stylesheet/less" type="text/css" href="../../resource/css/style.less" />
<link rel="stylesheet" href="../../resource/css/notification.css" />
<script src="../../resource/js/less.js" type="text/javascript"></script>
<script type="text/javascript" src="../../resource/kendoui/js/jquery.min.js"></script>
<script type="text/javascript" src="../../resource/kendoui/js/kendo.web.min.js"></script>
<script type="text/javascript" src="../../resource/js/headerFooterTemplate.js"></script>
<script type="text/javascript" src="../../resource/js/jquery.cookie.js"></script>
<script type="text/javascript" src="../../resource_new/js/fsn.js"></script>
<script type="text/javascript" src="../../resource/js/lims.js"></script>
<script type="text/javascript" src="../../resource/js/util.js"></script>
<script type="text/javascript" src="../../resource/js/language/system_zh-cn.js"></script>
<script type="text/javascript" src="../../resource/js/model.js"></script>
<script type="text/javascript" src="../../resource_new/js/upload/lims.upload.js"></script>
<!-- TestResult -->
<script src="../../resource/js/jquery-ui.1.11.4.js"></script>
<script type="text/javascript" src="../../resource/js/language/test_zh-cn.js"></script>
<script type="text/javascript" src="../../resource/js/lab/test-result-manage-notpub.js"></script>
<script type="text/javascript" src="../../resource/js/lab/test-property-preview.js"></script>
<script type="text/javascript" src="../../resource/js/lab/view-producer-manager.js"></script>
<style type="text/css">
 #busDetailWin .div-td-name{
 	width:120px;
 }
 .hideBtn{
 	display:none;
 }
</style>
</head>
<body>	
<!--Function Start Here  -->
	<div class="fullview" id="status_bar">
		<div class="container">
			<div class="row">
				<div class="column12">
					<span class="page_title" data-fsn-text="Test Result:">Test Result:</span>
				</div>
			</div>
		</div>
	</div>
	<br/>
	<div class="container" id="test_result_view">
		<input type="hidden" data-bind="value: testResult.id" />
		
		<div class="row">
			<div class="column12 last">
					<table>
						<tr>
							<td><label data-fsn-text="Id">Id</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.id, events: { change: change }" /></td>
						</tr>
						<tr>
							<td><label data-fsn-text="Product">Product Name</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.sample.product.name, events: { change: change }" /></td>
							<td>&nbsp;&nbsp;<label data-fsn-text="ReportNO">ReportNO</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.serviceOrder, events: { change: change }" /></td>							
						</tr>			
						<tr>
							<td><label data-fsn-text="BrandName">BrandName</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.sample.producer.name, events: { change: change }" /></td>
							<td>&nbsp;&nbsp;<label data-fsn-text="BatchSerialNo">BatchSerialNo</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.sample.batchSerialNo, events: { change: change }" /></td>
						</tr>
						<tr>
							<td><label data-fsn-text="SamplingLocation">SamplingLocation</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.samplingLocation, events: { change: change }" /></td>
							<td>&nbsp;&nbsp;<label data-fsn-text="SamplingDate">SamplingDate</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.samplingDate, events: { change: change }" /></td>							
						</tr>
						<tr>
							<td><label data-fsn-text="Testee">Testee</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.testee.name, events: { change: change }" /></td>
							<td>&nbsp;&nbsp;<label data-fsn-text="TestType">TestType</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.testType, events: { change: change }" /></td>
						</tr>
						<tr>
							<td><label data-fsn-text="Standard">Standard</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.standard, events: { change: change }" /></td>
							<td>&nbsp;&nbsp;<label data-fsn-text="ApproveBy">ApproveBy</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.approveBy, events: { change: change }" /></td>					
						</tr>
						<tr>
							<td><label data-fsn-text="KeyTester">KeyTester</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.keyTester, events: { change: change }" /></td>
							<td>&nbsp;&nbsp;<label data-fsn-text="AuditBy">AuditBy</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.auditBy, events: { change: change }" /></td>
						</tr>
						<tr>
							<td><label data-fsn-text="Test Date">Test Date</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.testDate, events: { change: change }" /></td>
							<td>&nbsp;&nbsp;<label data-fsn-text="Test Result:">Test Result:</label></td>
							<td><input type="text" readonly="readonly" class="k-textbox" data-bind="value: testResult.result, events: { change: change }" /></td>
						</tr>
                        <tr>
						<tr>
						    <td><label data-fsn-text="productCategory">productCategory</label></td>
							<td colspan="3">
							    <div>
							    <!--产品一级分类-->
    							<input type="text" readonly="readonly" style="width:150px" class="k-textbox" data-bind="value: testResult.sample.product.category.category.fristCategory.name, events: { change: change }" />
                                <!--产品二级分类-->
                                <label data-fsn-text="-">-</label>
    							<input type="text" readonly="readonly" style="width:150px" class="k-textbox" data-bind="value: testResult.sample.product.category.category.name, events: { change: change }" />
                                <!--产品三级分类-->
                                <label data-fsn-text="-">-</label>
    							<input type="text" readonly="readonly" style="width:150px" class="k-textbox" data-bind="value: testResult.sample.product.category.name, events: { change: change }" />
							    </div>
                            </td>
						</tr>
							<td><label data-fsn-text="Remark">Comment</label></td>
							<td colspan="3"><textarea rows="2" readonly="readonly" cols="30" id="comment" class="k-textbox" style="width:100%" data-bind="value: testResult.comment, events: { change: change }"></textarea></td>
							<!-- <td >&nbsp;&nbsp;<a class="k-button" id="producer_View" style="display:none"><span class="k-icon k-i-search"></span><span class="ui-button-text" data-fsn-text="Producer_View">Producer_View</span></a></td> -->
							<td>&nbsp;&nbsp;<a class="k-button" id="report_View"><span class="k-icon k-i-search"></span><span class="ui-button-text" data-fsn-text="Report_View">Report_View</span></a></td>
							<td>&nbsp;&nbsp;<a class="k-button" id="publish"><span class="k-icon k-update"></span><span class="ui-button-text" data-fsn-text="Publish">Publish</span></a></td>
							<td>&nbsp;&nbsp;<a class="k-button" id="Return"><span class="k-icon k-update"></span><span class="ui-button-text" data-fsn-text="Return">Return</span></a></td>
						</tr>
					</table>
					<script type="text/x-kendo-tmpl" id="uploadedFilesTemplate">
						<a href="#= attachments.url #" target="_blank">
						#= attachments.fileName #</a>&nbsp;,&nbsp;
					</script>
					<div id="proAtt_tr">产品图片:<div id="proAttachments"></div></div>
					<div id="msg_success" class="msg success"  style="margin-left: 125px; padding-top: 2%;"></div>
					检测项目：<div id="test_property_grid"></div>
					<br><br><br>
					<div id="backMsg" style="word-warp:break-word;word-break:break-all;z-index:10010;"></div>
		
		<div id="busDetailWin">
	     <div class="div-tr">
	     	<div class="div-td-name"><span data-fsn-text="enterpriseName"></span></div>
	     	<div class="div-td-value"><input id="businessName" class="k-textbox" disabled="disabled"/></div>
	     </div>
		<fieldset class="_previewFieldset">
  	  		<legend><span data-fsn-text="License Info"></span></legend>
  	  		<div>
  	  			<div class="div-tr">
  					<div class="div-td-name"><span data-fsn-text="License No"></span><font class="necessary">*</font></div>
  					<div class="div-td-value"><input id="licenseNo" class="k-textbox" disabled="disabled"/></div>
  	  			</div>
  	  			<div class="div-tr">
       				<div id="liceNoAttachmentsListView"></div>
				</div>
  	  			<div class="div-tr liceTrStatus">
  	  				<div class="div-td-name"><span data-fsn-text="Is Pass"></span></div>
  	  				<div class="div-td-value">
  	  					<input type="radio" name="liceTrMsg" id="liceY">是&nbsp;
  	  					<input type="radio" name="liceTrMsg" id="liceN">否
  	  				</div>
  	  			</div>
  	  			<div class="div-tr liceTrMsg">
  	  				<div class="div-td-name"><span data-fsn-text="Reject Reason"></span></div>
  	  				<div class="div-td-value">
  	  					<textarea rows="2" id="liceMsg" class="k-textbox" style="width:350px;"></textarea>
  	  				</div>
  	  			</div>
  	  		</div>
  	  	</fieldset>
		<fieldset class="_previewFieldset">
  	  		<legend><span data-fsn-text="Organization Info"></span></legend>
  	  		<div>
  	  			<div class="div-tr">
  					<div class="div-td-name"><span data-fsn-text="organization code"></span><font class="necessary">*</font></div>
  					<div class="div-td-value"><input id="orgCode" class="k-textbox" disabled="disabled"/></div>
  	  			</div>
  	  			<div class="div-tr">
      				<div id="orgAttachmentsListView"></div>
				</div>
  	  			<div class="div-tr orgCodeTrStatus">
  	  				<div class="div-td-name"><span data-fsn-text="Is Pass"></span></div>
  	  				<div class="div-td-name">
  	  					<input type="radio" name="orgCodeTrMsg" id="orgCodeY">是&nbsp;
  	  					<input type="radio" name="orgCodeTrMsg" id="orgCodeN">否
  	  				</div>
  	  			</div>
  	  			<div class="div-tr orgCodeTrMsg">
  	  				<div class="div-td-name"><span data-fsn-text="Reject Reason"></span></div>
  	  				<div class="div-td-name">
  	  					<textarea rows="2" cols="60" id="orgCodeMsg" class="k-textbox" style="width:350px;"></textarea>
  	  				</div>
  	  			</div>
  	  		</div>
  	  	</fieldset>
  	  	<fieldset class="_previewFieldset">
  	  		<legend><span data-fsn-text="Production license"></span></legend>
  	  		<div style="margin:0 auto;">
           		<div id="qs_grid"></div>
            </div>
  	  	</fieldset>
  	  	<div style="text-align: left;">
				<button id="btn_save" class="k-button" onclick="fsn.root.openTipsWindow('tipsWindow','注意！当前页面修改的信息，只有在报告执行发布或退回操作时才生效。');">
					<span class="k-icon k-update"></span><span data-fsn-text="OK"></span>
				</button> &nbsp;&nbsp;&nbsp;&nbsp;
				<!-- <button id="btn_cancel" class="k-button" onclick="fsn.root.closeWindow('busDetailWin');">
					<span class="k-icon k-cancel"></span><span data-fsn-text="Cancel"></span>
				</button>&nbsp;&nbsp; -->
		</div>
		<div id="viewQsWindow">
			<div class="div-tr">
				<div class="div-td-name"><span data-fsn-text="QS NO"></span></div>
				<div class="div-td-value"><input name="winQsNo" class="k-textbox"/></div>
			</div>
			<div id="qsAttachmentsListView"></div>
			<div class="div-tr qsNoTrStatus">
  	  			<div class="div-td-name"><span data-fsn-text="Is Pass"></span></div>
  	  			<div class="div-td-value">
  	  				<input type="radio" name="qsNoTrMsg" id="qsNoY">是&nbsp;
  	  				<input type="radio" name="qsNoTrMsg" id="qsNoN">否
  	  			</div>
  	  		</div>
  	  		<div class="div-tr qsNoTrMsg">
  	  			<div class="div-td-name"><span data-fsn-text="Reject Reason"></span></div>
  	  			<div class="div-td-value">
  	  				<textarea rows="2" cols="60" id="qsNoMsg" class="k-textbox" style="width:350px;"></textarea>
  	  			</div>
  	  		</div>
  	  		<div style="text-align: left;">
				<button id="btn_saveQs" class="k-button"><span class="k-icon k-update"></span><span data-fsn-text="OK"></span></button> &nbsp;&nbsp;&nbsp;&nbsp;
			</div>
		</div>
		<div id="tipsWindow">
			<div><span id="tipsMsg"></span></div>
			<div style="text-align: left;margin-top:25px;">
				<button id="btn_tipsOK" class="k-button" onclick="return fsn.root.closeWindow(['busDetailWin','tipsWindow']);">
					<span class="k-icon k-update"></span><span data-fsn-text="OK"></span>
				</button> &nbsp;&nbsp;&nbsp;&nbsp;
			</div>
		</div>
		<style>
    	.form-left{width:430px;float:left;}
    </style>
	<!-- 退回原因提示框 Start -->
	<div id="send_back_report_warn_window">
		<div style="text-align:left;font-size:18px;color:#000000">
			<p>
				<div class="form-left">
					<input type="checkbox" name="send_back_msg" alt="样品名称错误"/>样品名称错误&nbsp;<input type="text" class="k-input" />
				</div>
					<input type="checkbox" name="send_back_msg" alt="报告编号不正确或不完整"/>报告编号不正确或不完整&nbsp;<input type="text" class="k-input" />
			</p>
			<p>
				<div class="form-left">
			<input type="checkbox" name="send_back_msg" alt="生产企业名称错误"/>生产企业名称错误&nbsp;<input type="text" class="k-input" />
				</div>
			<input type="checkbox" name="send_back_msg" alt="批次日期错误"/>批次日期错误&nbsp;<input type="text" class="k-input" />
			</p>
			<p>
				<div class="form-left">
					<input type="checkbox" name="send_back_msg" alt="企业类型错误,应为"/>企业类型错误,应为&nbsp;<select class='k-select'><option value="企业自检">企业自检</option><option value="企业送检">企业送检</option><option value="政府抽检">政府抽检</option></select>
				</div>
			<input type="checkbox" name="send_back_msg" alt="检验依据错误,应与原报告完全一致"/>检验依据错误,应与原报告完全一致
			</p>
			<p>
				<div class="form-left">
			<input type="checkbox" name="send_back_msg" alt="检验结论错误，应与原报告完全一致"/>检验结论错误，应与原报告完全一致
				</div>
				<input type="checkbox" name="send_back_msg" alt="食品分类错误"/>食品分类错误&nbsp;<input type="text" class="k-input" />
			</p>
			<p>
				<div class="form-left">
					<input type="checkbox" name="send_back_msg" alt="产品图片"/>产品图片&nbsp;<select class='k-select'><option value="打不开">打不开</option><option value="未上传">未上传</option><option value="不清晰">不清晰</option><option value="不美观,当消费者查询时影响展示效果">不美观,当消费者查询时影响展示效果</option></select>
				</div>
			<input type="checkbox" name="send_back_msg" alt="上传报告"/>上传报告&nbsp;
			<select class='k-select'>
			<option value="不能歪斜，请上传扫描件">不能歪斜，请上传扫描件</option>
			<option value="不清晰">不清晰</option>
			<option value="打不开">打不开</option>
			<option value="缺页">缺页</option>
			<option value="页码顺序错误">页码顺序错误</option>
			<option value="与产品录入信息不匹配">与产品录入信息不匹配</option>
			</select>
			</p>
			<p>
				<div class="form-left">
			<input type="checkbox" name="send_back_msg" alt="检测项目错误，详见图片"/>检测项目错误，详见图片
				</div>
			</p>
			<p>
			<textarea class="k-textbox" cols="30" id="send_back_msg_other" placeholder="其他原因" style="width: 700px; height: 100px;"></textarea>
			</p>
			<p>
			附件说明:<input type="file" id="return_file" />
			</p>
			<p id="error-msg" style="color:red;"></p>
		</div>
		<div style="text-align: center;margin-top:38px" >
			<button class="k-button" id="send_back_report_yes_btn">
				<span class="k-icon k-update"></span>确定
			</button>
			&nbsp;&nbsp;&nbsp;&nbsp;
			<button class="k-button" id="send_back_report_no_btn">
				<span class="k-icon k-cancel"></span>取消
			</button>
		</div>
	</div>
	<!-- 退回原因提示框 End -->
		
	
	<!-- 消息提示框 Start -->
	<span id="RETURN_MES" style="display: none;"></span>
	<script id="errorTemplate" type="text/x-kendo-template">
            <div class="wrong-pass">
                <img src="../../resource/img/error-icon.png" style="display: inline-block;margin-left: 300px; margin-top: 10px;text-align: center;" width="20px" heigth= "20px"/>
                <br/>
                <img src="../../resource/img/error-icon.png" style="margin-top: 5px;"/><h3 style="width:240px; margin-top: -35px;margin-left: 40px;">#= message #</h3>
            </div>
        </script>
	<script id="successTemplate" type="text/x-kendo-template">
            <div class="upload-success">
                <img src="../../resource/img/error-icon.png" style="display: inline-block;margin-left: 300px; margin-top: 10px;text-align: center;" width="20px" heigth= "20px"/>
                <br/>
                <img src="../../resource/img/success-icon.png" style="margin-top: 5px;"/><h3 style="width:240px; margin-top: -35px;margin-left: 40px;">#= message #</h3>
            </div>
    </script>
    <!-- 消息提示框 End -->
	
		<!-- 针对于图片显示的模板
		<script type="text/x-kendo-tmpl" id="resTemplate">
			&nbsp;&nbsp;<a href="#=attachments.url!=null?attachments.url:'javascript:void(0);' #" target="_blank">#:attachments.fileName #</a>
   	 </script> -->
   	 <!-- 针对于QS图片的删除按钮模板 -->
	<script type="text/x-kendo-tmpl" id="delQsFilesTemplate">
		&nbsp;&nbsp;<a href="#=attachments.url!=null?attachments.url:'javascript:void(0);' #" target="_blank">#:attachments.fileName #</a>
		<button class="k-button" onclick="return fsn.root.removeQsRes(#=attachments.id#)">
        <span class="k-icon k-cancel"></span>删除</button><br><br>
    </script>
    <!-- 针对于组织机构图片的删除按钮模板 -->
	<script type="text/x-kendo-tmpl" id="delOrgFilesTemplate">
		&nbsp;&nbsp;<a href="#=attachments.url!=null?attachments.url:'javascript:void(0);' #" target="_blank">#:attachments.fileName #</a>
		<button class="k-button" onclick="return fsn.root.removeOrgRes(#=attachments.id#)">
        <span class="k-icon k-cancel"></span>删除</button><br><br>
    </script>
    <!-- 针对于营业执照图片的删除按钮模板 -->
	<script type="text/x-kendo-tmpl" id="delLiceNoFilesTemplate">
		&nbsp;&nbsp;<a href="#=attachments.url!=null?attachments.url:'javascript:void(0);' #" target="_blank">#:attachments.fileName #</a>
		<button class="k-button" onclick="return fsn.root.removeLicRes(#=attachments.id#)">
        <span class="k-icon k-cancel"></span>删除</button><br><br>
    </script>
	 </div>
	</div>
	</div>
	</div>
</body>
</html>